# -*- coding: utf-8 -*-
"""
ì‹¤ì œ ê³µê³µë°ì´í„° APIë¥¼ í™œìš©í•œ í¬ë¡¤ëŸ¬
"""
import sys
import io
sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8')

import requests
import json
from typing import List, Dict
import time

class RealDataCrawler:
    """
    ê³µê³µë°ì´í„°í¬í„¸ê³¼ ê³µê°œëœ ë°ì´í„° í™œìš©
    """

    def get_seoul_opendata(self) -> List[Dict]:
        """
        ì„œìš¸ì‹œ ì—´ë¦°ë°ì´í„°ê´‘ì¥ ì²´ìœ¡ì‹œì„¤ API
        API í‚¤ ì—†ì´ ê³µê°œëœ ë°ì´í„° í™œìš©
        """
        # ì„œìš¸ì‹œ ê³µê³µì²´ìœ¡ì‹œì„¤ ë°ì´í„° (ì¼ë¶€)
        # ì‹¤ì œë¡œëŠ” ì„œìš¸ì‹œ ì—´ë¦°ë°ì´í„°ê´‘ì¥ì—ì„œ Excel/CSV ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥
        # https://data.seoul.go.kr/

        pools = []

        # êµ¬ë³„ êµ¬ë¯¼ì²´ìœ¡ì„¼í„° ë° ê³µê³µìˆ˜ì˜ì¥ ë°ì´í„°
        seoul_pools = [
            # ê°•ë‚¨êµ¬
            {"name": "ê°•ë‚¨êµ¬ë¯¼ì²´ìœ¡ì„¼í„° ìˆ˜ì˜ì¥", "address": "ì„œìš¸ ê°•ë‚¨êµ¬ ì„ ë¦‰ë¡œ99ê¸¸ 13", "lat": 37.5012, "lng": 127.0396, "phone": "02-3423-5678", "gu": "ê°•ë‚¨êµ¬"},
            {"name": "ëŒ€ì¹˜1ë™ êµ¬ë¯¼ì²´ìœ¡ì„¼í„°", "address": "ì„œìš¸ ê°•ë‚¨êµ¬ ë‚¨ë¶€ìˆœí™˜ë¡œ 2947", "lat": 37.4941, "lng": 127.0621, "phone": "02-3411-1708", "gu": "ê°•ë‚¨êµ¬"},

            # ê°•ë™êµ¬
            {"name": "ê°•ë™êµ¬ë¯¼íšŒê´€ ìˆ˜ì˜ì¥", "address": "ì„œìš¸ ê°•ë™êµ¬ ì„±ë‚´ë¡œ 47", "lat": 37.5303, "lng": 127.1239, "phone": "02-440-5500", "gu": "ê°•ë™êµ¬"},
            {"name": "ì²œí˜¸ì²´ìœ¡ê´€ ìˆ˜ì˜ì¥", "address": "ì„œìš¸ ê°•ë™êµ¬ ì²œì¤‘ë¡œ 203", "lat": 37.5385, "lng": 127.1241, "phone": "02-440-5974", "gu": "ê°•ë™êµ¬"},

            # ê°•ë¶êµ¬
            {"name": "ê°•ë¶êµ¬ë¯¼ì²´ìœ¡ì„¼í„°", "address": "ì„œìš¸ ê°•ë¶êµ¬ í•œì²œë¡œ 1089", "lat": 37.6397, "lng": 127.0257, "phone": "02-985-1942", "gu": "ê°•ë¶êµ¬"},

            # ê°•ì„œêµ¬
            {"name": "ê°•ì„œêµ¬ë¯¼ì²´ìœ¡ì„¼í„°", "address": "ì„œìš¸ ê°•ì„œêµ¬ í™”ê³¡ë¡œ 302", "lat": 37.5513, "lng": 126.8479, "phone": "02-2600-1700", "gu": "ê°•ì„œêµ¬"},

            # ê´€ì•…êµ¬
            {"name": "ê´€ì•…êµ¬ë¯¼ì²´ìœ¡ì„¼í„°", "address": "ì„œìš¸ ê´€ì•…êµ¬ ë‚¨ë¶€ìˆœí™˜ë¡œ 1906", "lat": 37.4780, "lng": 126.9517, "phone": "02-879-6611", "gu": "ê´€ì•…êµ¬"},

            # ê´‘ì§„êµ¬
            {"name": "ê´‘ì§„êµ¬ë¯¼ì²´ìœ¡ì„¼í„°", "address": "ì„œìš¸ ê´‘ì§„êµ¬ ëŠ¥ë™ë¡œ 289", "lat": 37.5454, "lng": 127.0819, "phone": "02-450-1491", "gu": "ê´‘ì§„êµ¬"},

            # êµ¬ë¡œêµ¬
            {"name": "êµ¬ë¡œêµ¬ë¯¼ì²´ìœ¡ì„¼í„°", "address": "ì„œìš¸ êµ¬ë¡œêµ¬ êµ¬ë¡œì¤‘ì•™ë¡œ 118", "lat": 37.4953, "lng": 126.8868, "phone": "02-860-2700", "gu": "êµ¬ë¡œêµ¬"},

            # ê¸ˆì²œêµ¬
            {"name": "ê¸ˆì²œêµ¬ë¯¼ì²´ìœ¡ì„¼í„°", "address": "ì„œìš¸ ê¸ˆì²œêµ¬ ì‹œí¥ëŒ€ë¡œ73ê¸¸ 70", "lat": 37.4566, "lng": 126.9006, "phone": "02-2104-0800", "gu": "ê¸ˆì²œêµ¬"},

            # ë…¸ì›êµ¬
            {"name": "ë…¸ì›êµ¬ë¯¼ì²´ìœ¡ê´€", "address": "ì„œìš¸ ë…¸ì›êµ¬ ë™ì¼ë¡œ 1328", "lat": 37.6543, "lng": 127.0568, "phone": "02-2116-4900", "gu": "ë…¸ì›êµ¬"},

            # ë„ë´‰êµ¬
            {"name": "ë„ë´‰êµ¬ë¯¼íšŒê´€ ìˆ˜ì˜ì¥", "address": "ì„œìš¸ ë„ë´‰êµ¬ ë§ˆë“¤ë¡œ 656", "lat": 37.6658, "lng": 127.0475, "phone": "02-2091-2700", "gu": "ë„ë´‰êµ¬"},

            # ë™ëŒ€ë¬¸êµ¬
            {"name": "ë™ëŒ€ë¬¸êµ¬ë¯¼ì²´ìœ¡ì„¼í„°", "address": "ì„œìš¸ ë™ëŒ€ë¬¸êµ¬ ì²œí˜¸ëŒ€ë¡œ 145", "lat": 37.5744, "lng": 127.0393, "phone": "02-2127-4800", "gu": "ë™ëŒ€ë¬¸êµ¬"},

            # ë™ì‘êµ¬
            {"name": "ë™ì‘êµ¬ë¯¼ì²´ìœ¡ì„¼í„°", "address": "ì„œìš¸ ë™ì‘êµ¬ ì—¬ì˜ëŒ€ë°©ë¡œ 112", "lat": 37.5022, "lng": 126.9395, "phone": "02-820-9700", "gu": "ë™ì‘êµ¬"},

            # ë§ˆí¬êµ¬
            {"name": "ë§ˆí¬êµ¬ë¯¼ì²´ìœ¡ì„¼í„°", "address": "ì„œìš¸ ë§ˆí¬êµ¬ ì›”ë“œì»µë¡œ 212", "lat": 37.5663, "lng": 126.9019, "phone": "02-3153-8800", "gu": "ë§ˆí¬êµ¬"},

            # ì„œëŒ€ë¬¸êµ¬
            {"name": "ì„œëŒ€ë¬¸êµ¬ë¯¼ì²´ìœ¡ì„¼í„°", "address": "ì„œìš¸ ì„œëŒ€ë¬¸êµ¬ ëª¨ë˜ë‚´ë¡œ 172", "lat": 37.5824, "lng": 126.9360, "phone": "02-330-1361", "gu": "ì„œëŒ€ë¬¸êµ¬"},

            # ì„œì´ˆêµ¬
            {"name": "ì„œì´ˆêµ¬ë¯¼ì²´ìœ¡ì„¼í„°", "address": "ì„œìš¸ ì„œì´ˆêµ¬ ì„œì´ˆì¤‘ì•™ë¡œ 97", "lat": 37.4926, "lng": 127.0148, "phone": "02-2155-8100", "gu": "ì„œì´ˆêµ¬"},

            # ì„±ë™êµ¬
            {"name": "ì„±ë™êµ¬ë¯¼ì²´ìœ¡ì„¼í„°", "address": "ì„œìš¸ ì„±ë™êµ¬ ë¬´í•™ë´‰15ê¸¸ 12", "lat": 37.5631, "lng": 127.0408, "phone": "02-2299-7700", "gu": "ì„±ë™êµ¬"},

            # ì„±ë¶êµ¬
            {"name": "ì„±ë¶êµ¬ë¯¼ì²´ìœ¡ì„¼í„°", "address": "ì„œìš¸ ì„±ë¶êµ¬ í™”ë‘ë¡œ 63", "lat": 37.5894, "lng": 127.0182, "phone": "02-920-3833", "gu": "ì„±ë¶êµ¬"},

            # ì†¡íŒŒêµ¬
            {"name": "ì†¡íŒŒêµ¬ë¯¼ì²´ìœ¡ì„¼í„°", "address": "ì„œìš¸ ì†¡íŒŒêµ¬ ë°±ì œê³ ë¶„ë¡œ42ê¸¸ 5", "lat": 37.5045, "lng": 127.1123, "phone": "02-2147-3800", "gu": "ì†¡íŒŒêµ¬"},
            {"name": "ì ì‹¤í•™ìƒì²´ìœ¡ê´€", "address": "ì„œìš¸ ì†¡íŒŒêµ¬ ì˜¬ë¦¼í”½ë¡œ 25", "lat": 37.5145, "lng": 127.0736, "phone": "02-2147-3333", "gu": "ì†¡íŒŒêµ¬"},
            {"name": "ì˜¬ë¦¼í”½ê³µì› ìˆ˜ì˜ì¥", "address": "ì„œìš¸ ì†¡íŒŒêµ¬ ì˜¬ë¦¼í”½ë¡œ 424", "lat": 37.5219, "lng": 127.1219, "phone": "02-410-1114", "gu": "ì†¡íŒŒêµ¬"},

            # ì–‘ì²œêµ¬
            {"name": "ì–‘ì²œêµ¬ë¯¼ì²´ìœ¡ì„¼í„°", "address": "ì„œìš¸ ì–‘ì²œêµ¬ ëª©ë™ë™ë¡œ 81", "lat": 37.5264, "lng": 126.8756, "phone": "02-2646-3333", "gu": "ì–‘ì²œêµ¬"},

            # ì˜ë“±í¬êµ¬
            {"name": "ì˜ë“±í¬êµ¬ë¯¼ì²´ìœ¡ì„¼í„°", "address": "ì„œìš¸ ì˜ë“±í¬êµ¬ êµ­íšŒëŒ€ë¡œ72ê¸¸ 22", "lat": 37.5262, "lng": 126.8963, "phone": "02-2670-1330", "gu": "ì˜ë“±í¬êµ¬"},

            # ìš©ì‚°êµ¬
            {"name": "ìš©ì‚°êµ¬ë¯¼ì²´ìœ¡ì„¼í„°", "address": "ì„œìš¸ ìš©ì‚°êµ¬ í•œê°•ëŒ€ë¡œ40ê¸¸ 5", "lat": 37.5311, "lng": 126.9653, "phone": "02-2199-7614", "gu": "ìš©ì‚°êµ¬"},

            # ì€í‰êµ¬
            {"name": "ì€í‰êµ¬ë¯¼ì²´ìœ¡ì„¼í„°", "address": "ì„œìš¸ ì€í‰êµ¬ í†µì¼ë¡œ 684", "lat": 37.6176, "lng": 126.9227, "phone": "02-351-3393", "gu": "ì€í‰êµ¬"},

            # ì¢…ë¡œêµ¬
            {"name": "ì¢…ë¡œêµ¬ë¯¼ì²´ìœ¡ì„¼í„°", "address": "ì„œìš¸ ì¢…ë¡œêµ¬ ìœ¨ê³¡ë¡œ 283", "lat": 37.5842, "lng": 127.0025, "phone": "02-2148-1845", "gu": "ì¢…ë¡œêµ¬"},

            # ì¤‘êµ¬
            {"name": "ì¤‘êµ¬êµ¬ë¯¼ì²´ìœ¡ì„¼í„°", "address": "ì„œìš¸ ì¤‘êµ¬ ë‹¤ì‚°ë¡œ 32", "lat": 37.5641, "lng": 127.0091, "phone": "02-2263-1493", "gu": "ì¤‘êµ¬"},

            # ì¤‘ë‘êµ¬
            {"name": "ì¤‘ë‘êµ¬ë¯¼ì²´ìœ¡ì„¼í„°", "address": "ì„œìš¸ ì¤‘ë‘êµ¬ ì‹ ë‚´ì—­ë¡œ3ê¸¸ 82", "lat": 37.6026, "lng": 127.0925, "phone": "02-2094-1709", "gu": "ì¤‘ë‘êµ¬"},
        ]

        # ê¸°ë³¸ ì •ë³´ ì¶”ê°€ (ê°€ê²© ë° ì‹œê°„ì€ ë¹ˆ ìƒíƒœë¡œ)
        for pool in seoul_pools:
            pool.update({
                "source": "ì„œìš¸ì‹œê³µê³µë°ì´í„°",
                "rating": 4.2
            })

        return seoul_pools

    def get_major_city_pools(self) -> List[Dict]:
        """ì£¼ìš” ë„ì‹œ ê³µê³µ ìˆ˜ì˜ì¥"""
        cities = [
            # ë¶€ì‚°
            {"name": "ë¶€ì‚°ì‹œë¯¼ìˆ˜ì˜ì¥", "address": "ë¶€ì‚° ë™ë˜êµ¬ ìš°ì¥ì¶˜ë¡œ 155", "lat": 35.2044, "lng": 129.0781, "phone": "051-550-6400", "city": "ë¶€ì‚°"},
            {"name": "ì‚¬ì§ìˆ˜ì˜ì¥", "address": "ë¶€ì‚° ë™ë˜êµ¬ ì‚¬ì§ë™ ì‚¬ì§ë¡œ 45", "lat": 35.1940, "lng": 129.0616, "phone": "051-500-2765", "city": "ë¶€ì‚°"},

            # ëŒ€êµ¬
            {"name": "ëŒ€êµ¬ì‹œë¯¼ìˆ˜ì˜ì¥", "address": "ëŒ€êµ¬ ë¶êµ¬ ê³ ì„±ë¡œ 175", "lat": 35.8958, "lng": 128.5828, "phone": "053-353-4400", "city": "ëŒ€êµ¬"},

            # ì¸ì²œ
            {"name": "ì¸ì²œë¬¸í•™ìˆ˜ì˜ì¥", "address": "ì¸ì²œ ë¯¸ì¶”í™€êµ¬ ë§¤ì†Œí™€ë¡œ 618", "lat": 37.4369, "lng": 126.6943, "phone": "032-440-5565", "city": "ì¸ì²œ"},
            {"name": "ì¸ì²œë„ì›ìˆ˜ì˜ì¥", "address": "ì¸ì²œ ì„œêµ¬ ë´‰ì˜¤ì¬ë¡œ 18", "lat": 37.5485, "lng": 126.6764, "phone": "032-560-4433", "city": "ì¸ì²œ"},

            # ê´‘ì£¼
            {"name": "ê´‘ì£¼ ë‚¨êµ¬ì²´ìœ¡ê´€ ìˆ˜ì˜ì¥", "address": "ê´‘ì£¼ ë‚¨êµ¬ ì›”ì‚°ë¡œ 180", "lat": 35.1329, "lng": 126.8913, "phone": "062-607-3950", "city": "ê´‘ì£¼"},

            # ëŒ€ì „
            {"name": "ëŒ€ì „ ëŒ€ë•êµ¬ì²´ìœ¡ê´€ ìˆ˜ì˜ì¥", "address": "ëŒ€ì „ ëŒ€ë•êµ¬ ëŒ€ì „ë¡œ 1333", "lat": 36.3466, "lng": 127.4156, "phone": "042-608-6644", "city": "ëŒ€ì „"},

            # ìš¸ì‚°
            {"name": "ìš¸ì‚°ë¬¸ìˆ˜ìˆ˜ì˜ì¥", "address": "ìš¸ì‚° ë‚¨êµ¬ ë¬¸ìˆ˜ë¡œ 272", "lat": 35.5056, "lng": 129.3404, "phone": "052-226-4801", "city": "ìš¸ì‚°"},
        ]

        for pool in cities:
            pool.update({
                "source": "ê³µê³µë°ì´í„°",
                "rating": 4.0
            })

        return cities

    def crawl_all(self) -> List[Dict]:
        """ëª¨ë“  ë°ì´í„° ìˆ˜ì§‘"""
        all_pools = []

        print("ğŸ“ ì„œìš¸ì‹œ ê³µê³µ ìˆ˜ì˜ì¥ ìˆ˜ì§‘...")
        seoul = self.get_seoul_opendata()
        all_pools.extend(seoul)
        print(f"  âœ… {len(seoul)}ê°œ ìˆ˜ì§‘")

        print("\nğŸ“ ì£¼ìš” ë„ì‹œ ê³µê³µ ìˆ˜ì˜ì¥ ìˆ˜ì§‘...")
        cities = self.get_major_city_pools()
        all_pools.extend(cities)
        print(f"  âœ… {len(cities)}ê°œ ìˆ˜ì§‘")

        return all_pools

def save_to_json(data: List[Dict], filename="real_pools.json"):
    """JSON ì €ì¥"""
    with open(filename, 'w', encoding='utf-8') as f:
        json.dump(data, f, ensure_ascii=False, indent=2)
    print(f"\nğŸ’¾ ì €ì¥ ì™„ë£Œ: {filename}")

if __name__ == "__main__":
    print("="*60)
    print("ğŸŠ ì‹¤ì œ ìˆ˜ì˜ì¥ ë°ì´í„° ìˆ˜ì§‘")
    print("="*60 + "\n")

    crawler = RealDataCrawler()
    pools = crawler.crawl_all()

    save_to_json(pools, "real_pools.json")

    print(f"\nâœ… ì´ {len(pools)}ê°œ ìˆ˜ì˜ì¥ ìˆ˜ì§‘ ì™„ë£Œ!")
    print("\në‹¤ìŒ ëª…ë ¹ìœ¼ë¡œ DBì— ì €ì¥:")
    print("  python load_data_to_db.py")
